"use strict";const BigNumber=require("./bignumber.js-9.0.2.min.js"),Common=require("./common.min.js"),Slatepack=require("./slatepack.min.js"),Consensus=require("./consensus.min.js");class Slate{constructor(e,t,i,r,s=Slate.NO_LOCK_HEIGHT,n=Slate.NO_RELATIVE_HEIGHT,a=Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT,o=Slate.NO_SENDER_ADDRESS,u=Slate.NO_RECEIVER_ADDRESS,g=[]){if(this.reset(),e instanceof Uint8Array==!0){var l=e,_=i,h=r;this.unserialize(l,t,_,h)}else if(!0===Object.isObject(e)){l=e,_=i,h=r;this.unserialize(l,t,_,h)}else{if(e instanceof BigNumber!=!0)throw"Unsupported slate.";var c=e,E=i,S=r;this.amount=c,this.fee=E,this.height=S,this.lockHeight=s,this.relativeHeight=n,this.timeToLiveCutOffHeight=a,this.senderAddress=o,this.receiverAddress=u,this.kernels.push(new SlateKernel(this.getKernelFeatures(),this.getFee(),this.getLockHeight(),this.getRelativeHeight())),this.blockHeaderVersion=Consensus.getHeaderVersion(t,this.getHeight()),this.version=this.minimumCompatibleVersion(g),this.originalVersion=this.getVersion()}}serialize(e,t){switch(this.getVersion()instanceof BigNumber==!0?this.getVersion().toFixed():this.getVersion()){case Slate.VERSION_TWO.toFixed():case Slate.VERSION_THREE.toFixed():var i=this,r={amount:this.getAmount().toFixed(),fee:this.getFee().toFixed(),height:this.getHeight().toFixed(),id:this.getId().serialize(),lock_height:this.getLockHeight().toFixed(),num_participants:this.getNumberOfParticipants(),participant_data:this.getParticipants().map((function(e){return e.serialize(i)})),tx:{body:{inputs:this.getInputs().map((function(e){return e.serialize(i)})),kernels:this.getKernels().map((function(e){return e.serialize(i)})),outputs:this.getOutputs().map((function(e){return e.serialize(i)}))},offset:Common.toHexString(this.getOffset())},version_info:{block_header_version:this.getBlockHeaderVersion(),orig_version:this.getOriginalVersion(),version:this.getVersion()}};return!0===this.getVersion().isGreaterThanOrEqualTo(Slate.VERSION_THREE)&&(r.ttl_cutoff_height=this.getTimeToLiveCutOffHeight()!==Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT?this.getTimeToLiveCutOffHeight().toFixed():Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT,r.payment_proof=!0===this.hasPaymentProof()?{receiver_address:this.getReceiverAddress(),receiver_signature:this.getReceiverSignature()!==Slate.NO_RECEIVER_SIGNATURE?Common.toHexString(this.getReceiverSignature()):null,sender_address:this.getSenderAddress()}:Slate.NO_PAYMENT_PROOF,r.coin_type=Slate.COIN_TYPE,r.network_type=Slate.getNetworkType(e)),r;case Slate.VERSION_SLATEPACK:var s=new BitWriter;try{if(s.setBits(t,Slate.COMPACT_SLATE_PURPOSE_LENGTH),s.setBytes(this.getId().getData()),s.setBits(e?Slate.COMPACT_BOOLEAN_TRUE:Slate.COMPACT_BOOLEAN_FALSE,Slate.COMPACT_BOOLEAN_LENGTH),t===Slate.COMPACT_SLATE_PURPOSE_SEND_INITIAL&&(Slate.compactUint64(this.getAmount(),!0,s),Slate.compactUint64(this.getFee(),!0,s)),Slate.compactUint64(this.getHeight(),!1,s),Slate.compactUint64(this.getLockHeight(),!1,s),this.getTimeToLiveCutOffHeight()!==Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT?(s.setBits(Slate.COMPACT_BOOLEAN_TRUE,Slate.COMPACT_BOOLEAN_LENGTH),Slate.compactUint64(this.getTimeToLiveCutOffHeight(),!1,s)):s.setBits(Slate.COMPACT_BOOLEAN_FALSE,Slate.COMPACT_BOOLEAN_LENGTH),t===Slate.COMPACT_SLATE_PURPOSE_SEND_INITIAL&&(this.getParticipant(SlateParticipant.SENDER_ID).serialize(this,s),!0===this.hasPaymentProof()?(s.setBits(Slate.COMPACT_BOOLEAN_TRUE,Slate.COMPACT_BOOLEAN_LENGTH),Slate.compactProofAddress(this.getSenderAddress(),e,s),Slate.compactProofAddress(this.getReceiverAddress(),e,s)):s.setBits(Slate.COMPACT_BOOLEAN_FALSE,Slate.COMPACT_BOOLEAN_LENGTH)),t===Slate.COMPACT_SLATE_PURPOSE_SEND_RESPONSE){s.setBytes(this.getOffset());for(var n=0;n<this.getOutputs().length;++n){(o=this.getOutputs()[n]).serialize(this,s),n!==this.getOutputs().length-1?s.setBits(Slate.COMPACT_BOOLEAN_TRUE,Slate.COMPACT_BOOLEAN_LENGTH):s.setBits(Slate.COMPACT_BOOLEAN_FALSE,Slate.COMPACT_BOOLEAN_LENGTH)}for(n=0;n<this.getKernels().length;++n){this.getKernels()[n].serialize(this,s),n!==this.getKernels().length-1?s.setBits(Slate.COMPACT_BOOLEAN_TRUE,Slate.COMPACT_BOOLEAN_LENGTH):s.setBits(Slate.COMPACT_BOOLEAN_FALSE,Slate.COMPACT_BOOLEAN_LENGTH)}if(this.getParticipant(SlateParticipant.SENDER_ID.plus(1)).serialize(this,s),!0===this.hasPaymentProof())if(s.setBits(Slate.COMPACT_BOOLEAN_TRUE,Slate.COMPACT_BOOLEAN_LENGTH),Slate.compactProofAddress(this.getSenderAddress(),e,s),Slate.compactProofAddress(this.getReceiverAddress(),e,s),this.getReceiverSignature()!==Slate.NO_RECEIVER_SIGNATURE){if(s.setBits(Slate.COMPACT_BOOLEAN_TRUE,Slate.COMPACT_BOOLEAN_LENGTH),this.getReceiverSignature().length<Crypto.ED25519_SIGNATURE_LENGTH||this.getReceiverSignature().length-Crypto.ED25519_SIGNATURE_LENGTH>=Math.pow(2,Slate.COMPACT_PROOF_SIGNATURE_LENGTH_LENGTH))throw"Receiver signature is too short or too long.";s.setBits(this.getReceiverSignature().length-Crypto.ED25519_SIGNATURE_LENGTH,Slate.COMPACT_PROOF_SIGNATURE_LENGTH_LENGTH),s.setBytes(this.getReceiverSignature())}else s.setBits(Slate.COMPACT_BOOLEAN_FALSE,Slate.COMPACT_BOOLEAN_LENGTH);else s.setBits(Slate.COMPACT_BOOLEAN_FALSE,Slate.COMPACT_BOOLEAN_LENGTH),s.setBits(Slate.COMPACT_BOOLEAN_FALSE,Slate.COMPACT_BOOLEAN_LENGTH)}return s.getBytes()}catch(e){throw"Compacting slate failed."}break;case Slate.VERSION_FOUR.toFixed():r={id:this.getId().serialize(),sta:Slate.purposeToText(t),ver:this.getVersion().toFixed()+Slate.VERSION_SEPARATOR+this.getBlockHeaderVersion().toFixed()};switch(!1===this.getNumberOfParticipants().isEqualTo(Slate.DEFAULT_NUMBER_OF_PARTICIPANTS)&&(r.num_parts=this.getNumberOfParticipants()),this.getTimeToLiveCutOffHeight()!==Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT&&(r.ttl=this.getTimeToLiveCutOffHeight().toFixed()),this.getKernelFeatures()){case SlateKernel.PLAIN_FEATURES:break;case SlateKernel.HEIGHT_LOCKED_FEATURES:r.feat=this.getKernelFeatures(),r.feat_args={lock_hgt:this.getLockHeight().toFixed()};break;default:throw"Unsupported features."}if(!0===this.hasPaymentProof()&&(r.proof={raddr:Common.toHexString(Slatepack.slatepackAddressToPublicKey(this.getReceiverAddress())),saddr:Common.toHexString(Slatepack.slatepackAddressToPublicKey(this.getSenderAddress()))},this.getReceiverSignature()!==Slate.NO_RECEIVER_SIGNATURE&&(r.proof.rsig=Common.toHexString(this.getReceiverSignature()))),t===Slate.COMPACT_SLATE_PURPOSE_SEND_INITIAL&&(r.amt=this.getAmount().toFixed(),r.fee=this.getFee().toFixed(),r.sigs=[this.getParticipant(SlateParticipant.SENDER_ID).serialize(this)]),t===Slate.COMPACT_SLATE_PURPOSE_SEND_RESPONSE){r.off=Common.toHexString(this.getOffset()),r.sigs=[this.getParticipant(SlateParticipant.SENDER_ID.plus(1)).serialize(this)],r.coms=[];for(n=0;n<this.getInputs().length;++n){var a=this.getInputs()[n];r.coms.push(a.serialize(this))}for(n=0;n<this.getOutputs().length;++n){var o=this.getOutputs()[n];r.coms.push(o.serialize(this))}}return r;default:throw"Unsupported slate version."}}getTransaction(){return{body:{inputs:this.getInputs().map((function(e){return e.getTransaction()})),kernels:this.getKernels().map((function(e){return e.getTransaction()})),outputs:this.getOutputs().map((function(e){return e.getTransaction()}))},offset:Common.toHexString(this.getOffset())}}getNumberOfParticipants(){return this.numberOfParticipants}getId(){return this.id}changeId(){this.id=new Uuid(Uuid.randomSerializedUuid())}getOffset(){return this.offset}getInputs(){return this.inputs}getOutputs(){return this.outputs}getKernels(){return this.kernels}getAmount(){return this.amount}getFee(){return this.fee}getHeight(){return this.height}getLockHeight(){return this.lockHeight}getRelativeHeight(){return this.relativeHeight}getTimeToLiveCutOffHeight(){return this.timeToLiveCutOffHeight}getParticipants(){return this.participants}getVersion(){return this.version}getOriginalVersion(){return this.originalVersion}getBlockHeaderVersion(){return this.blockHeaderVersion}getReceiverAddress(){return this.receiverAddress}getReceiverSignature(){return this.receiverSignature}setReceiverAddress(e){this.receiverAddress=e}setReceiverSignature(e,t){return this.receiverSignature=e,!1!==this.verifyReceiverSignature(t)}getSenderAddress(){return this.senderAddress}getParticipant(e){for(var t=0;t<this.getParticipants().length;++t){var i=this.getParticipants()[t];if(!0===i.getId().isEqualTo(e))return i}return Slate.NO_PARTICIPANT}addOutputs(e,t=!0){!0===t&&this.updateKernel();for(var i=0;i<e.length;++i){var r=e[i];this.outputs.push(r)}return!1!==this.sort()&&(!1!==this.verifyWeight()&&(!1!==this.verifySortedAndUnique()&&!1!==this.verifyNoCutThrough()))}addInputs(e,t=!0){!0===t&&this.updateKernel();for(var i=0;i<e.length;++i){var r=e[i];this.inputs.push(r)}return!1!==this.sort()&&(!1!==this.verifyWeight()&&(!1!==this.verifySortedAndUnique()&&!1!==this.verifyNoCutThrough()))}createOffset(){do{crypto.getRandomValues(this.offset)}while(!1===Secp256k1Zkp.isValidSecretKey(this.getOffset()))}applyOffset(e,t=HardwareWallet.NO_TEXT,i=[],r=!1,s=!1,n=Common.NO_CANCEL_OCCURED){var a=this;return new Promise((function(o,u){if(e instanceof Uint8Array!=!0)return e.applyOffsetToTransaction(a.getOffset(),t,i,r,s,n).then((function(){o()})).catch((function(e){u(e)}));var g=e;if(!1===Secp256k1Zkp.isValidSecretKey(g))u("Secret key isn't a valid secret key.");else{var l=Secp256k1Zkp.blindSum([g],[a.getOffset()]);l===Secp256k1Zkp.OPERATION_FAILED?u("Getting blind offset from secret key and offset failed."):!1===Secp256k1Zkp.isValidSecretKey(l)?(l.fill(0),u("Blind offset isn't a valid secret key.")):o(l)}}))}combineOffsets(e){return this.offset=Secp256k1Zkp.blindSum([this.getOffset(),e.getOffset()],[]),this.getOffset()!==Secp256k1Zkp.OPERATION_FAILED&&!1!==Secp256k1Zkp.isValidSecretKey(this.getOffset())}addParticipant(e,t,i,r,s=HardwareWallet.NO_TEXT,n=[],a=!1,o=!1,u=Common.NO_CANCEL_OCCURED){var g=this;return new Promise((function(l,_){for(var h=SlateParticipant.SENDER_ID;g.getParticipant(h)!==Slate.NO_PARTICIPANT;)h=h.plus(1);return new Promise((function(t,i){if(e instanceof Uint8Array!=1)return e.getTransactionPublicKey(s,n,a,o,u).then((function(e){t(e)})).catch((function(e){i(e)}));var r=e,g=Secp256k1Zkp.publicKeyFromSecretKey(r);g===Secp256k1Zkp.OPERATION_FAILED?i("Getting public blind excess failed."):t(g)})).then((function(c){return new Promise((function(t,r){if(i!==SlateParticipant.NO_MESSAGE){if(e instanceof Uint8Array!=1)return e.getTransactionMessageSignature(i,c,s,n,a,o,u).then((function(e){t(e)})).catch((function(e){r(e)}));var g=e,l=Blake2b.compute(Crypto.SINGLE_SIGNER_MESSAGE_LENGTH,(new TextEncoder).encode(i),new Uint8Array);if(l===Blake2b.OPERATION_FAILED)return void r("Getting message's hash failed.");var _=Secp256k1Zkp.createSingleSignerSignature(l,g,Secp256k1Zkp.NO_SECRET_NONCE,c,Secp256k1Zkp.NO_PUBLIC_NONCE,Secp256k1Zkp.NO_PUBLIC_NONCE_TOTAL);if(_===Secp256k1Zkp.OPERATION_FAILED)return void r("Creating message signature.");t(_)}else t(SlateParticipant.NO_MESSAGE_SIGNATURE)})).then((function(E){return new Promise((function(i,r){if(e instanceof Uint8Array!=1)return e.getTransactionPublicNonce(s,n,a,o,u).then((function(e){i(e)})).catch((function(e){r(e)}));var g=t,l=Secp256k1Zkp.publicKeyFromSecretKey(g);l===Secp256k1Zkp.OPERATION_FAILED?r("Getting a public nonce failed."):i(l)})).then((function(S){var p=g.getReceiverSignature();return new Promise((function(i,l){if(!0!==h.isEqualTo(SlateParticipant.SENDER_ID))return g.createPartialSignature(e,t,!0,r,s,n,a,o,u).then((function(e){i(e)})).catch((function(e){l(e)}));i(SlateParticipant.NO_PARTIAL_SIGNATURE)})).then((function(e){try{var t=new SlateParticipant(h,c,S,e,i,E)}catch(e){return g.setReceiverSignature(p),void _("Creating participant failed.")}g.getParticipants().push(t),!1===g.verifyPartialSignatures()?(g.getParticipants().pop(),g.setReceiverSignature(p),_("Verifying partial signature failed.")):l()})).catch((function(e){_(e)}))})).catch((function(e){_(e)}))})).catch((function(e){_(e)}))})).catch((function(e){_(e)}))}))}finalize(e,t,i,r,s=HardwareWallet.NO_TEXT,n=[],a=!1,o=!1,u=Common.NO_CANCEL_OCCURED){var g=this;return new Promise((function(l,_){return g.createPartialSignature(e,t,!1,r,s,n,a,o,u).then((function(e){var t=g.getParticipant(SlateParticipant.SENDER_ID),s=t.getPartialSignature();if(t.setPartialSignature(e),!1===g.verifyPartialSignatures())t.setPartialSignature(s),_("Verifying partial signature failed.");else{for(var n=[],a=0;a<g.getParticipants().length;++a){var o=g.getParticipants()[a];if(!0!==o.isComplete())return t.setPartialSignature(s),void _("Participant isn't complete.");n.push(o.getPartialSignature())}var u=Secp256k1Zkp.combinePublicKeys(g.getParticipants().map((function(e){return e.getPublicNonce()})));if(u===Secp256k1Zkp.OPERATION_FAILED)t.setPartialSignature(s),_("Getting public nonce sum failed.");else{var h=Secp256k1Zkp.combinePublicKeys(g.getParticipants().map((function(e){return e.getPublicBlindExcess()})));if(h===Secp256k1Zkp.OPERATION_FAILED)t.setPartialSignature(s),_("Getting public blind excess sum failed.");else{var c=Secp256k1Zkp.addSingleSignerSignatures(n,u);if(c===Secp256k1Zkp.OPERATION_FAILED)t.setPartialSignature(s),_("Getting final signature failed.");else{try{var E=SlateKernel.signatureMessage(g.getKernelFeatures(),g.getFee(),g.getLockHeight(),g.getRelativeHeight())}catch(e){return t.setPartialSignature(s),void _("Getting message to sign failed.")}if(!1===Secp256k1Zkp.verifySingleSignerSignature(c,E,Secp256k1Zkp.NO_PUBLIC_NONCE,h,h,!0))t.setPartialSignature(s),_("Verifying final signature failed.");else if(1!==g.getKernels().length)t.setPartialSignature(s),_("Only one kernel doesn't exist.");else if(!0===g.getKernels()[0].isComplete())t.setPartialSignature(s),_("Kernel is already complete.");else{var S=g.getKernels()[0].getExcess();g.getKernels()[0].setExcess(g.getExcess());var p=g.getKernels()[0].getExcessSignature();!1===g.getKernels()[0].setExcessSignature(c)?(g.getKernels()[0].setExcess(S),g.getKernels()[0].setExcessSignature(p),t.setPartialSignature(s),_("Setting kernel's excess signature failed.")):!1===g.sort()?(g.getKernels()[0].setExcess(S),g.getKernels()[0].setExcessSignature(p),t.setPartialSignature(s),_("Sorting failed.")):!1===g.verifyWeight()||!1===g.verifySortedAndUnique()?(g.getKernels()[0].setExcess(S),g.getKernels()[0].setExcessSignature(p),t.setPartialSignature(s),_("Verifying weight failed.")):!1===g.verifyNoCutThrough()?(g.getKernels()[0].setExcess(S),g.getKernels()[0].setExcessSignature(p),t.setPartialSignature(s),_("Verifying no cut through failed.")):!1===g.verifyFees(i)?(g.getKernels()[0].setExcess(S),g.getKernels()[0].setExcessSignature(p),t.setPartialSignature(s),_("Verifying fees failed.")):!1===g.getKernels()[0].isComplete()?(g.getKernels()[0].setExcess(S),g.getKernels()[0].setExcessSignature(p),t.setPartialSignature(s),_("Kernel isn't complete.")):!1===g.verifyKernelSums()?(g.getKernels()[0].setExcess(S),g.getKernels()[0].setExcessSignature(p),t.setPartialSignature(s),_("Verifying kernel sums failed.")):!0===g.hasPaymentProof()&&g.getReceiverSignature()===Slate.NO_RECEIVER_SIGNATURE?(g.getKernels()[0].setExcess(S),g.getKernels()[0].setExcessSignature(p),t.setPartialSignature(s),_("Receiver signature doesn't exist.")):!1===g.verifyReceiverSignature(r)?(g.getKernels()[0].setExcess(S),g.getKernels()[0].setExcessSignature(p),t.setPartialSignature(s),_("Verifying receiver signature failed.")):!1===g.verifyNoRecentDuplicateKernels(r)?(g.getKernels()[0].setExcess(S),g.getKernels()[0].setExcessSignature(p),t.setPartialSignature(s),_("Verifying no recent duplicate kernels failed.")):l()}}}}}})).catch((function(e){_(e)}))}))}getOffsetExcess(){var e=Secp256k1Zkp.pedersenCommit(this.getOffset(),new BigNumber(0).toFixed());if(e===Secp256k1Zkp.OPERATION_FAILED)throw"Performing Pedersen commit with the offset and zero failed.";return e}getExcess(e=Slate.NO_PUBLIC_BLIND_EXCESS){if(!0===this.isCompact()){var t=this.getParticipants().map((function(e){return e.getPublicBlindExcess()}));e!==Slate.NO_PUBLIC_BLIND_EXCESS&&t.push(e);var i=Secp256k1Zkp.combinePublicKeys(t);if(i===Secp256k1Zkp.OPERATION_FAILED)throw"Getting public blind excess sum failed.";if((s=Secp256k1Zkp.publicKeyToPedersenCommit(i))===Secp256k1Zkp.OPERATION_FAILED)throw"Getting excess from public blind excess sum failed.";return s}try{var r=this.getOffsetExcess()}catch(e){throw e}var s,n=this.getCommitsSum();if(!1===n)throw"Getting transaction excess from commits sum failed.";if((s=Secp256k1Zkp.pedersenCommitSum([n],[r]))===Secp256k1Zkp.OPERATION_FAILED)throw"Getting excess from transaction excess and offset excess failed.";return s}isEqualTo(e){if(!1===Common.arraysAreEqual(this.getId().getData(),e.getId().getData()))return!1;if(!1===this.getAmount().isEqualTo(e.getAmount()))return!1;if(!1===this.getFee().isEqualTo(e.getFee()))return!1;if(!1===this.getLockHeight().isEqualTo(e.getLockHeight()))return!1;if(this.getRelativeHeight()===Slate.NO_RELATIVE_HEIGHT&&e.getRelativeHeight()!==Slate.NO_RELATIVE_HEIGHT||this.getRelativeHeight()!==Slate.NO_RELATIVE_HEIGHT&&e.getRelativeHeight()===Slate.NO_RELATIVE_HEIGHT||this.getRelativeHeight()!==Slate.NO_RELATIVE_HEIGHT&&!1===this.getRelativeHeight().isEqualTo(e.getRelativeHeight()))return!1;if(this.getHeight()===Slate.UNKNOWN_HEIGHT&&e.getHeight()!==Slate.UNKNOWN_HEIGHT||this.getHeight()!==Slate.UNKNOWN_HEIGHT&&e.getHeight()===Slate.UNKNOWN_HEIGHT||this.getHeight()!==Slate.NO_HEIGHT&&!1===this.getHeight().isEqualTo(e.getHeight()))return!1;if(this.getTimeToLiveCutOffHeight()===Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT&&e.getTimeToLiveCutOffHeight()!==Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT||this.getTimeToLiveCutOffHeight()!==Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT&&e.getTimeToLiveCutOffHeight()===Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT||this.getTimeToLiveCutOffHeight()!==Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT&&!1===this.getTimeToLiveCutOffHeight().isEqualTo(e.getTimeToLiveCutOffHeight()))return!1;if(!1===this.getNumberOfParticipants().isEqualTo(e.getNumberOfParticipants()))return!1;if(!1===this.isCompact()&&!1===Common.arraysAreEqual(this.getOffset(),e.getOffset()))return!1;if(!1===this.getBlockHeaderVersion().isEqualTo(e.getBlockHeaderVersion()))return!1;if(this.getOriginalVersion()instanceof BigNumber==!0&&(e.getOriginalVersion()instanceof BigNumber==!1||!1===this.getOriginalVersion().isEqualTo(e.getOriginalVersion()))||"string"==typeof this.getOriginalVersion()&&("string"!=typeof e.getOriginalVersion()||this.getOriginalVersion()!==e.getOriginalVersion()))return!1;if(this.getVersion()instanceof BigNumber==!0&&(e.getVersion()instanceof BigNumber==!1||!0===this.getVersion().isLessThan(e.getVersion()))||"string"==typeof this.getVersion()&&("string"!=typeof e.getVersion()||this.getVersion()!==e.getVersion()))return!1;if(this.getReceiverAddress()!==e.getReceiverAddress())return!1;if(this.getSenderAddress()!==e.getSenderAddress())return!1;if(this.getInputs().length!==e.getInputs().length)return!1;for(var t=0;t<this.getInputs().length;++t)if(!1===this.getInputs()[t].isEqualTo(e.getInputs()[t]))return!1;if(this.getKernels().length!==e.getKernels().length)return!1;for(t=0;t<this.getKernels().length;++t)if(!1===this.getKernels()[t].isEqualTo(e.getKernels()[t]))return!1;for(t=0;t<this.getOutputs().length;++t){for(var i=!1,r=0;r<e.getOutputs().length;++r)if(!0===this.getOutputs()[t].isEqualTo(e.getOutputs()[r])){i=!0;break}if(!1===i)return!1}for(t=0;t<this.getParticipants().length;++t){var s=!1;for(r=0;r<e.getParticipants().length;++r)if(!0===this.getParticipants()[t].isEqualTo(e.getParticipants()[r])){s=!0;break}if(!1===s)return!1}return!0}isCompact(){return this.getVersion()===Slate.VERSION_SLATEPACK||this.getVersion()instanceof BigNumber==!0&&!0===this.getVersion().isGreaterThanOrEqualTo(Slate.VERSION_FOUR)}static getPaymentProofMessage(e,t,i){switch(Consensus.getWalletType()){case Consensus.MWC_WALLET_TYPE:return(new TextEncoder).encode(Common.toHexString(t)+i+e.toFixed());case Consensus.GRIN_WALLET_TYPE:return Common.mergeArrays([e.toBytes(BigNumber.BIG_ENDIAN,Common.BYTES_IN_A_UINT64),t,Slatepack.slatepackAddressToPublicKey(i)])}}static get SUPPORTED_VERSIONS(){switch(Consensus.getWalletType()){case Consensus.MWC_WALLET_TYPE:return[Slate.VERSION_SLATEPACK,"V"+Slate.VERSION_THREE.toFixed()+"B","V"+Slate.VERSION_THREE.toFixed(),"V"+Slate.VERSION_TWO.toFixed()];case Consensus.GRIN_WALLET_TYPE:return["V"+Slate.VERSION_FOUR.toFixed()]}}static getRequiredFee(e,t,i,r){switch(Consensus.getWalletType()){case Consensus.MWC_WALLET_TYPE:!0===(s=new BigNumber(t).multipliedBy(Slate.BODY_WEIGHT_OUTPUT_FACTOR).plus(i).minus(e)).isLessThan(Slate.MINIMUM_BODY_WEIGHT)&&(s=new BigNumber(Slate.MINIMUM_BODY_WEIGHT));break;case Consensus.GRIN_WALLET_TYPE:var s=Slate.getWeight(e,t,i)}return s.multipliedBy(r)}static uncompactUint64(e,t){if(!0===t)var i=e.getBits(Slate.COMPACT_NUMBER_OF_HUNDREDS_LENGTH);for(var r=e.getBits(Slate.COMPACT_NUMBER_OF_DIGITS_LENGTH)+1,s=new Uint8Array(1+Math.floor((r-1)/Common.BITS_IN_A_BYTE)),n=0,a=r;a>0;++n,a-=Common.BITS_IN_A_BYTE)s[n]=e.getBits(Math.min(a,Common.BITS_IN_A_BYTE));if(r>Common.BITS_IN_A_BYTE&&r%Common.BITS_IN_A_BYTE!=0)for(n=s.length-1;n>=0;--n)n!==s.length-1&&(s[n]>>>=Common.BITS_IN_A_BYTE-r%Common.BITS_IN_A_BYTE),0!==n&&(s[n]|=s[n-1]<<r%Common.BITS_IN_A_BYTE);var o=new BigNumber(Common.HEX_PREFIX+Common.toHexString(s));if(!0===t)for(n=0;n<i;++n)o=o.multipliedBy(Slate.COMPACT_HUNDREDS_SCALING_FACTOR);return o}static compactUint64(e,t,i){if(!0===t)for(var r=0;!0===e.modulo(Slate.COMPACT_HUNDREDS_SCALING_FACTOR).isZero()&&r<Math.pow(2,Slate.COMPACT_NUMBER_OF_HUNDREDS_LENGTH)-1;)e=e.dividedToIntegerBy(Slate.COMPACT_HUNDREDS_SCALING_FACTOR),++r;for(var s=1,n=new BigNumber(1);s<Math.pow(2,Slate.COMPACT_NUMBER_OF_DIGITS_LENGTH)&&!0===n.isLessThan(e);n=n.multipliedBy(2))++s;!0===t&&i.setBits(r,Slate.COMPACT_NUMBER_OF_HUNDREDS_LENGTH),i.setBits(s-1,Slate.COMPACT_NUMBER_OF_DIGITS_LENGTH);var a=e.toBytes(BigNumber.BIG_ENDIAN,Math.ceil(s/Common.BITS_IN_A_BYTE));for(n=0;n<a.length;++n)s%Common.BITS_IN_A_BYTE!=0?n!==a.length-1?(a[n]<<=Common.BITS_IN_A_BYTE-s%Common.BITS_IN_A_BYTE,a[n]|=a[n+1]>>>s%Common.BITS_IN_A_BYTE,i.setBits(a[n],Common.BITS_IN_A_BYTE)):i.setBits(a[n],s%Common.BITS_IN_A_BYTE):i.setBits(a[n],Common.BITS_IN_A_BYTE)}static uncompactPublicKey(e){var t=e.getBits(Slate.COMPACT_PUBLIC_KEY_LENGTH_LENGTH);return e.getBytes(t)}static compactPublicKey(e,t){if(e.length>=Math.pow(2,Slate.COMPACT_PUBLIC_KEY_LENGTH_LENGTH))throw"Public key is too long.";t.setBits(e.length,Slate.COMPACT_PUBLIC_KEY_LENGTH_LENGTH),t.setBytes(e)}static get NO_TIME_TO_LIVE_CUT_OFF_HEIGHT(){return null}static get NO_PAYMENT_PROOF(){return null}static get NEWEST_VERSION(){switch(Consensus.getWalletType()){case Consensus.MWC_WALLET_TYPE:return Slate.VERSION_SLATEPACK;case Consensus.GRIN_WALLET_TYPE:return Slate.VERSION_FOUR}}static get NO_ENCRYPTED_SECRET_NONCE(){return null}static get UNKNOWN_HEIGHT(){return null}static get MINIMUM_FEE(){return 1}static get MAXIMUM_FEE(){switch(Consensus.getWalletType()){case Consensus.MWC_WALLET_TYPE:return Number.POSITIVE_INFINITY;case Consensus.GRIN_WALLET_TYPE:return Math.pow(2,40)-1}}reset(){this.version=Slate.NEWEST_VERSION,this.originalVersion=this.getVersion(),this.blockHeaderVersion=Consensus.LEGACY_HEADER_VERSION,this.numberOfParticipants=Slate.DEFAULT_NUMBER_OF_PARTICIPANTS,this.offset=Slate.ZERO_OFFSET,this.inputs=[],this.outputs=[],this.kernels=[],this.amount=new BigNumber(Slate.MINIMUM_AMOUNT),this.fee=new BigNumber(Slate.MINIMUM_FEE),this.height=Slate.UNKNOWN_HEIGHT,this.lockHeight=Slate.NO_LOCK_HEIGHT,this.relativeHeight=Slate.NO_RELATIVE_HEIGHT,this.timeToLiveCutOffHeight=Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT,this.participants=[],this.receiverAddress=Slate.NO_RECEIVER_ADDRESS,this.receiverSignature=Slate.NO_RECEIVER_SIGNATURE,this.senderAddress=Slate.NO_SENDER_ADDRESS,this.changeId()}unserialize(e,t,i,r){var s=Slate.detectVersion(e,t);if(s===Slate.UNKNOWN_VERSION)throw"Unsupported slate.";switch(s instanceof BigNumber==!0?s.toFixed():s){case Slate.VERSION_TWO.toFixed():case Slate.VERSION_THREE.toFixed():if("version_info"in e==!1||!1===Object.isObject(e.version_info))throw"Unsupported slate.";if("version"in e.version_info==!1||!1===Common.isNumberString(e.version_info.version)&&e.version_info.version instanceof BigNumber==!1||!1===new BigNumber(e.version_info.version).isInteger()||!0===new BigNumber(e.version_info.version).isLessThan(Slate.VERSION_ONE))throw"Unsupported slate.";if(this.version=new BigNumber(e.version_info.version),"num_participants"in e==!1||!1===Common.isNumberString(e.num_participants)&&e.num_participants instanceof BigNumber==!1||!1===new BigNumber(e.num_participants).isInteger()||!0===new BigNumber(e.num_participants).isLessThan(Slate.MINIMUM_NUMBER_OF_PARTICIPANTS))throw"Unsupported slate.";if(this.numberOfParticipants=new BigNumber(e.num_participants),"amount"in e==!1||!1===Common.isNumberString(e.amount)&&e.amount instanceof BigNumber==!1||!1===new BigNumber(e.amount).isInteger()||!0===new BigNumber(e.amount).isLessThan(Slate.MINIMUM_AMOUNT))throw"Unsupported slate.";if(this.amount=new BigNumber(e.amount),"fee"in e==!1||!1===Common.isNumberString(e.fee)&&e.fee instanceof BigNumber==!1||!1===new BigNumber(e.fee).isInteger()||!0===new BigNumber(e.fee).isLessThan(Slate.MINIMUM_FEE)||!0===new BigNumber(e.fee).isGreaterThan(Slate.MAXIMUM_FEE))throw"Unsupported slate.";if(this.fee=new BigNumber(e.fee),"height"in e==!1||!1===Common.isNumberString(e.height)&&e.height instanceof BigNumber==!1||!1===new BigNumber(e.height).isInteger()||!0===new BigNumber(e.height).isLessThan(Consensus.FIRST_BLOCK_HEIGHT))throw"Unsupported slate.";if(this.height=new BigNumber(e.height),"lock_height"in e==!1||!1===Common.isNumberString(e.lock_height)&&e.lock_height instanceof BigNumber==!1||!1===new BigNumber(e.lock_height).isInteger()||!0===new BigNumber(e.lock_height).isLessThan(Slate.NO_LOCK_HEIGHT))throw"Unsupported slate.";if(this.lockHeight=new BigNumber(e.lock_height),"orig_version"in e.version_info==!1||!1===Common.isNumberString(e.version_info.orig_version)&&e.version_info.orig_version instanceof BigNumber==!1||!1===new BigNumber(e.version_info.orig_version).isInteger()||!0===new BigNumber(e.version_info.orig_version).isLessThan(Slate.VERSION_ONE))throw"Unsupported slate.";if(this.originalVersion=new BigNumber(e.version_info.orig_version),"block_header_version"in e.version_info==!1||!1===Common.isNumberString(e.version_info.block_header_version)&&e.version_info.block_header_version instanceof BigNumber==!1||!1===new BigNumber(e.version_info.block_header_version).isInteger()||!1===Consensus.isValidHeaderVersion(t,this.getHeight(),new BigNumber(e.version_info.block_header_version)))throw"Unsupported slate.";if(this.blockHeaderVersion=new BigNumber(e.version_info.block_header_version),!0===this.getVersion().isGreaterThanOrEqualTo(Slate.VERSION_THREE)){if("ttl_cutoff_height"in e==!1||null!==e.ttl_cutoff_height&&(!1===Common.isNumberString(e.ttl_cutoff_height)&&e.ttl_cutoff_height instanceof BigNumber==!1||!1===new BigNumber(e.ttl_cutoff_height).isInteger()||!0===new BigNumber(e.ttl_cutoff_height).isLessThanOrEqualTo(this.getHeight())||!0===new BigNumber(e.ttl_cutoff_height).isLessThan(this.getLockHeight())))throw"Unsupported slate.";if(this.timeToLiveCutOffHeight=null!==e.ttl_cutoff_height?new BigNumber(e.ttl_cutoff_height):Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT,"payment_proof"in e==!1||null!==e.payment_proof&&!1===Object.isObject(e.payment_proof))throw"Unsupported slate.";if(null!==e.payment_proof&&("receiver_address"in e.payment_proof==!1||"string"!=typeof e.payment_proof.receiver_address||e.payment_proof.receiver_address.length!==Mqs.ADDRESS_LENGTH&&e.payment_proof.receiver_address.length!==Tor.ADDRESS_LENGTH))throw"Unsupported slate.";if(null!==e.payment_proof){switch(e.payment_proof.receiver_address.length){case Mqs.ADDRESS_LENGTH:try{Mqs.mqsAddressToPublicKey(e.payment_proof.receiver_address,t)}catch(e){throw"Unsupported slate."}break;case Tor.ADDRESS_LENGTH:try{Tor.torAddressToPublicKey(e.payment_proof.receiver_address)}catch(e){throw"Unsupported slate."}}this.receiverAddress=e.payment_proof.receiver_address}else this.receiverAddress=Slate.NO_RECEIVER_ADDRESS;if(null!==e.payment_proof&&("receiver_signature"in e.payment_proof==!1||null!==e.payment_proof.receiver_signature&&(!1===Common.isHexString(e.payment_proof.receiver_signature)||Common.hexStringLength(e.payment_proof.receiver_signature)>Crypto.MAXIMUM_MESSAGE_HASH_SIGNATURE_LENGTH&&Common.hexStringLength(e.payment_proof.receiver_signature)!==Crypto.ED25519_SIGNATURE_LENGTH)))throw"Unsupported slate.";if(this.receiverSignature=null!==e.payment_proof&&null!==e.payment_proof.receiver_signature?Common.fromHexString(e.payment_proof.receiver_signature):Slate.NO_RECEIVER_SIGNATURE,null!==e.payment_proof&&("sender_address"in e.payment_proof==!1||"string"!=typeof e.payment_proof.sender_address||e.payment_proof.sender_address.length!==Mqs.ADDRESS_LENGTH&&e.payment_proof.sender_address.length!==Tor.ADDRESS_LENGTH))throw"Unsupported slate.";if(null!==e.payment_proof){switch(e.payment_proof.sender_address.length){case Mqs.ADDRESS_LENGTH:try{Mqs.mqsAddressToPublicKey(e.payment_proof.sender_address,t)}catch(e){throw"Unsupported slate."}break;case Tor.ADDRESS_LENGTH:try{Tor.torAddressToPublicKey(e.payment_proof.sender_address)}catch(e){throw"Unsupported slate."}}this.senderAddress=e.payment_proof.sender_address}else this.senderAddress=Slate.NO_SENDER_ADDRESS}if("id"in e==!1||"string"!=typeof e.id)throw"Unsupported slate.";try{if(this.id=new Uuid(e.id),!1===this.getId().isRandom())throw"Unsupported slate."}catch(e){throw"Unsupported slate."}if("tx"in e==!1||!1===Object.isObject(e.tx))throw"Unsupported slate.";if("body"in e.tx==!1||!1===Object.isObject(e.tx.body))throw"Unsupported slate.";if("inputs"in e.tx.body==!1||!1===Array.isArray(e.tx.body.inputs))throw"Unsupported slate.";try{var n=this;this.inputs=e.tx.body.inputs.map((function(e){if(!1===Object.isObject(e))throw"Unsupported slate.";return new SlateInput(e,n)}))}catch(e){throw"Unsupported slate."}if(0===this.getInputs().length)throw"Unsupported slate.";if("outputs"in e.tx.body==!1||!1===Array.isArray(e.tx.body.outputs))throw"Unsupported slate.";try{this.outputs=e.tx.body.outputs.map((function(e){if(!1===Object.isObject(e))throw"Unsupported slate.";return new SlateOutput(e,n)}))}catch(e){throw"Unsupported slate."}if("kernels"in e.tx.body==!1||!1===Array.isArray(e.tx.body.kernels))throw"Unsupported slate.";try{this.kernels=e.tx.body.kernels.map((function(e){if(!1===Object.isObject(e))throw"Unsupported slate.";return new SlateKernel(e,n,t)}))}catch(e){throw"Unsupported slate."}if("offset"in e.tx==!1||!1===Common.isHexString(e.tx.offset)||Common.hexStringLength(e.tx.offset)!==Crypto.BLINDING_FACTOR_LENGTH||!1===Secp256k1Zkp.isValidSecretKey(Common.fromHexString(e.tx.offset)))throw"Unsupported slate.";if(this.offset=Common.fromHexString(e.tx.offset),"participant_data"in e==!1||!1===Array.isArray(e.participant_data)||!0===this.getNumberOfParticipants().isLessThan(e.participant_data.length))throw"Unsupported slate.";try{this.participants=e.participant_data.map((function(e){if(!1===Object.isObject(e))throw"Unsupported slate.";return new SlateParticipant(e,n)}))}catch(e){throw"Unsupported slate."}break;case Slate.VERSION_SLATEPACK:var a=new BitReader(e);try{if(this.version=s,this.originalVersion=this.getVersion(),a.getBits(Slate.COMPACT_SLATE_PURPOSE_LENGTH)!==i)throw"Unsupported slate.";if(this.id=new Uuid(Uuid.serializeData(a.getBytes(Uuid.BYTE_LENGTH))),!1===this.getId().isRandom())throw"Unsupported slate.";if(a.getBits(Slate.COMPACT_BOOLEAN_LENGTH)===Slate.COMPACT_BOOLEAN_TRUE!==t)throw"Unsupported slate.";if(i===Slate.COMPACT_SLATE_PURPOSE_SEND_INITIAL){if(this.amount=Slate.uncompactUint64(a,!0),!0===this.getAmount().isLessThan(Slate.MINIMUM_AMOUNT))throw"Unsupported slate.";if(this.fee=Slate.uncompactUint64(a,!0),!0===this.getFee().isLessThan(Slate.MINIMUM_FEE)||!0===this.getFee().isGreaterThan(Slate.MAXIMUM_FEE))throw"Unsupported slate."}if(this.height=Slate.uncompactUint64(a,!1),!0===this.getHeight().isLessThan(Consensus.FIRST_BLOCK_HEIGHT))throw"Unsupported slate.";if(this.blockHeaderVersion=Consensus.getHeaderVersion(t,this.getHeight()),this.lockHeight=Slate.uncompactUint64(a,!1),!0===this.getLockHeight().isLessThan(Slate.NO_LOCK_HEIGHT))throw"Unsupported slate.";if(a.getBits(Slate.COMPACT_BOOLEAN_LENGTH)===Slate.COMPACT_BOOLEAN_TRUE){if(this.timeToLiveCutOffHeight=Slate.uncompactUint64(a,!1),!0===this.getTimeToLiveCutOffHeight().isLessThanOrEqualTo(this.getHeight())||!0===this.getTimeToLiveCutOffHeight().isLessThan(this.getLockHeight()))throw"Unsupported slate."}else this.timeToLiveCutOffHeight=Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT;if(i===Slate.COMPACT_SLATE_PURPOSE_SEND_INITIAL){if(this.participants.push(new SlateParticipant(a,this)),a.getBits(Slate.COMPACT_BOOLEAN_LENGTH)===Slate.COMPACT_BOOLEAN_TRUE){switch(this.senderAddress=Slate.uncompactProofAddress(a,t),this.getSenderAddress().length){case Mqs.ADDRESS_LENGTH:try{Mqs.mqsAddressToPublicKey(this.getSenderAddress(),t)}catch(e){throw"Unsupported slate."}break;case Tor.ADDRESS_LENGTH:try{Tor.torAddressToPublicKey(this.getSenderAddress())}catch(e){throw"Unsupported slate."}break;default:throw"Unsupported slate."}switch(this.receiverAddress=Slate.uncompactProofAddress(a,t),this.getReceiverAddress().length){case Mqs.ADDRESS_LENGTH:try{Mqs.mqsAddressToPublicKey(this.getReceiverAddress(),t)}catch(e){throw"Unsupported slate."}break;case Tor.ADDRESS_LENGTH:try{Tor.torAddressToPublicKey(this.getReceiverAddress())}catch(e){throw"Unsupported slate."}break;default:throw"Unsupported slate."}}else this.receiverAddress=Slate.NO_RECEIVER_ADDRESS,this.senderAddress=Slate.NO_SENDER_ADDRESS;this.kernels.push(new SlateKernel(this.getKernelFeatures(),this.getFee(),this.getLockHeight(),this.getRelativeHeight()))}if(i===Slate.COMPACT_SLATE_PURPOSE_SEND_RESPONSE){if(this.numberOfParticipants=r.getNumberOfParticipants(),this.amount=r.getAmount(),this.fee=r.getFee(),this.inputs=r.getInputs().map((function(e){return new SlateInput(e.getFeatures(),e.getCommit())})),this.outputs=r.getOutputs().map((function(e){return new SlateOutput(e.getFeatures(),e.getCommit(),e.getProof())})),this.participants=r.getParticipants().map((function(e){return new SlateParticipant(e.getId(),e.getPublicBlindExcess(),e.getPublicNonce(),e.getPartialSignature(),e.getMessage(),e.getMessageSignature())})),this.offset=a.getBytes(Crypto.BLINDING_FACTOR_LENGTH),!1===Secp256k1Zkp.isValidSecretKey(this.getOffset()))throw"Unsupported slate.";do{this.addOutputs([new SlateOutput(a,this)],!1)}while(a.getBits(Slate.COMPACT_BOOLEAN_LENGTH)===Slate.COMPACT_BOOLEAN_TRUE);do{this.kernels.push(new SlateKernel(a,this,t))}while(a.getBits(Slate.COMPACT_BOOLEAN_LENGTH)===Slate.COMPACT_BOOLEAN_TRUE);if(this.participants.push(new SlateParticipant(a,this)),a.getBits(Slate.COMPACT_BOOLEAN_LENGTH)===Slate.COMPACT_BOOLEAN_TRUE){switch(this.senderAddress=Slate.uncompactProofAddress(a,t),this.getSenderAddress().length){case Mqs.ADDRESS_LENGTH:try{Mqs.mqsAddressToPublicKey(this.getSenderAddress(),t)}catch(e){throw"Unsupported slate."}break;case Tor.ADDRESS_LENGTH:try{Tor.torAddressToPublicKey(this.getSenderAddress())}catch(e){throw"Unsupported slate."}break;default:throw"Unsupported slate."}switch(this.receiverAddress=Slate.uncompactProofAddress(a,t),this.getReceiverAddress().length){case Mqs.ADDRESS_LENGTH:try{Mqs.mqsAddressToPublicKey(this.getReceiverAddress(),t)}catch(e){throw"Unsupported slate."}break;case Tor.ADDRESS_LENGTH:try{Tor.torAddressToPublicKey(this.getReceiverAddress())}catch(e){throw"Unsupported slate."}break;default:throw"Unsupported slate."}}else this.receiverAddress=Slate.NO_RECEIVER_ADDRESS,this.senderAddress=Slate.NO_SENDER_ADDRESS;if(a.getBits(Slate.COMPACT_BOOLEAN_LENGTH)===Slate.COMPACT_BOOLEAN_TRUE){var o=a.getBits(Slate.COMPACT_PROOF_SIGNATURE_LENGTH_LENGTH)+Crypto.ED25519_SIGNATURE_LENGTH;if(o>Crypto.MAXIMUM_MESSAGE_HASH_SIGNATURE_LENGTH&&o!==Crypto.ED25519_SIGNATURE_LENGTH)throw"Unsupported slate.";this.receiverSignature=a.getBytes(o)}else this.receiverSignature=Slate.NO_RECEIVER_SIGNATURE}}catch(e){throw"Unsupported slate."}break;case Slate.VERSION_FOUR.toFixed():if(this.version=s,this.originalVersion=this.getVersion(),"sta"in e==!1||"string"!=typeof e.sta||e.sta!==Slate.purposeToText(i))throw"Unsupported slate.";if("num_parts"in e==!0&&(!1===Common.isNumberString(e.num_parts)&&e.num_parts instanceof BigNumber==!1||!1===new BigNumber(e.num_parts).isInteger()||!0===new BigNumber(e.num_parts).isLessThan(Slate.MINIMUM_NUMBER_OF_PARTICIPANTS)))throw"Unsupported slate.";if(this.numberOfParticipants="num_parts"in e==!0?new BigNumber(e.num_parts):Slate.DEFAULT_NUMBER_OF_PARTICIPANTS,"id"in e==!1||"string"!=typeof e.id)throw"Unsupported slate.";try{if(this.id=new Uuid(e.id),!1===this.getId().isRandom())throw"Unsupported slate."}catch(e){throw"Unsupported slate."}if("ver"in e==!1||"string"!=typeof e.ver||!1===Slate.VERSION_PATTERN.test(e.ver))throw"Unsupported slate.";if(this.blockHeaderVersion=new BigNumber(e.ver.split(Slate.VERSION_SEPARATOR)[1]),"feat"in e==!0)switch(e.feat){case SlateKernel.PLAIN_FEATURES:break;case SlateKernel.HEIGHT_LOCKED_FEATURES:if("feat_args"in e==!1||null===e.feat_args||!1===Object.isObject(e.feat_args)||"lock_hgt"in e.feat_args==!1||!1===Common.isNumberString(e.feat_args.lock_hgt)&&e.feat_args.lock_hgt instanceof BigNumber==!1||!1===new BigNumber(e.feat_args.lock_hgt).isInteger()||!0===new BigNumber(e.feat_args.lock_hgt).isLessThan(Slate.NO_LOCK_HEIGHT))throw"Unsupported slate.";this.lockHeight=new BigNumber(e.feat_args.lock_hgt);break;default:throw"Unsupported slate."}else if("feat_args"in e==!0&&null!==e.feat_args)throw"Unsupported slate.";if("ttl"in e==!0&&null!==e.ttl&&(!1===Common.isNumberString(e.ttl)&&e.ttl instanceof BigNumber==!1||!1===new BigNumber(e.ttl).isInteger()||!0===new BigNumber(e.ttl).isLessThan(Consensus.FIRST_BLOCK_HEIGHT)||!1===this.getLockHeight().isEqualTo(Slate.NO_LOCK_HEIGHT)&&!0===new BigNumber(e.ttl).isLessThan(this.getLockHeight())))throw"Unsupported slate.";if(this.timeToLiveCutOffHeight="ttl"in e==!0&&null!==e.ttl?new BigNumber(e.ttl):Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT,i===Slate.COMPACT_SLATE_PURPOSE_SEND_RESPONSE&&(this.participants=r.getParticipants().map((function(e){return new SlateParticipant(e.getId(),e.getPublicBlindExcess(),e.getPublicNonce(),e.getPartialSignature(),e.getMessage(),e.getMessageSignature())}))),"sigs"in e==!1||!1===Array.isArray(e.sigs)||!0===this.getNumberOfParticipants().isLessThan(e.sigs.length+this.participants.length))throw"Unsupported slate.";try{for(var u=0;u<e.sigs.length;++u){var g=e.sigs[u];if(!1===Object.isObject(g))throw"Unsupported slate.";this.participants.push(new SlateParticipant(g,this))}}catch(e){throw"Unsupported slate."}if("proof"in e==!0&&null!==e.proof){if(!1===Object.isObject(e.proof))throw"Unsupported slate.";if("raddr"in e.proof==!1||!1===Common.isHexString(e.proof.raddr)||Common.hexStringLength(e.proof.raddr)!==Crypto.ED25519_PUBLIC_KEY_LENGTH)throw"Unsupported slate.";try{this.receiverAddress=Slatepack.publicKeyToSlatepackAddress(Common.fromHexString(e.proof.raddr))}catch(e){throw"Unsupported slate."}if("rsig"in e.proof==!0&&null!==e.proof.rsig&&(!1===Common.isHexString(e.proof.rsig)||Common.hexStringLength(e.proof.rsig)!==Crypto.ED25519_SIGNATURE_LENGTH))throw"Unsupported slate.";if(this.receiverSignature="rsig"in e.proof==!0&&null!==e.proof.rsig?Common.fromHexString(e.proof.rsig):Slate.NO_RECEIVER_SIGNATURE,"saddr"in e.proof==!1||!1===Common.isHexString(e.proof.saddr)||Common.hexStringLength(e.proof.saddr)!==Crypto.ED25519_PUBLIC_KEY_LENGTH)throw"Unsupported slate.";try{this.senderAddress=Slatepack.publicKeyToSlatepackAddress(Common.fromHexString(e.proof.saddr))}catch(e){throw"Unsupported slate."}}if(i===Slate.COMPACT_SLATE_PURPOSE_SEND_INITIAL){if("coms"in e==!0&&null!==e.coms)throw"Unsupported slate.";if("amt"in e==!1||!1===Common.isNumberString(e.amt)&&e.amt instanceof BigNumber==!1||!1===new BigNumber(e.amt).isInteger()||!0===new BigNumber(e.amt).isLessThan(Slate.MINIMUM_AMOUNT))throw"Unsupported slate.";if(this.amount=new BigNumber(e.amt),"fee"in e==!1||!1===Common.isNumberString(e.fee)&&e.fee instanceof BigNumber==!1||!1===new BigNumber(e.fee).isInteger()||!0===new BigNumber(e.fee).isLessThan(Slate.MINIMUM_FEE)||!0===new BigNumber(e.fee).isGreaterThan(Slate.MAXIMUM_FEE))throw"Unsupported slate.";if(this.fee=new BigNumber(e.fee),"off"in e==!0&&(!1===Common.isHexString(e.off)||!1===Common.arraysAreEqual(Common.fromHexString(e.off),Slate.ZERO_OFFSET)))throw"Unsupported slate."}if(i===Slate.COMPACT_SLATE_PURPOSE_SEND_RESPONSE){if(this.inputs=r.getInputs().map((function(e){return new SlateInput(e.getFeatures(),e.getCommit())})),this.outputs=r.getOutputs().map((function(e){return new SlateOutput(e.getFeatures(),e.getCommit(),e.getProof())})),"coms"in e==!1||null===e.coms||!1===Array.isArray(e.coms))throw"Unsupported slate.";var l=[],_=[];try{for(u=0;u<e.coms.length;++u){var h=e.coms[u];if(!1===Object.isObject(h))throw"Unsupported slate.";"p"in h==!0&&null!==h.p?_.push(new SlateOutput(h,this)):l.push(new SlateInput(h,this))}}catch(e){throw"Unsupported slate."}if(this.addInputs(l,!1),this.addOutputs(_,!1),"amt"in e==!0&&(!1===Common.isNumberString(e.amt)&&e.amt instanceof BigNumber==!1||!1===new BigNumber(e.amt).isInteger()||!0===new BigNumber(e.amt).isLessThan(Slate.MINIMUM_AMOUNT)))throw"Unsupported slate.";if(this.amount="amt"in e==!0?new BigNumber(e.amt):r.getAmount(),"fee"in e==!0&&(!1===Common.isNumberString(e.fee)&&e.fee instanceof BigNumber==!1||!1===new BigNumber(e.fee).isInteger()||!0===new BigNumber(e.fee).isLessThan(Slate.MINIMUM_FEE)||!0===new BigNumber(e.fee).isGreaterThan(Slate.MAXIMUM_FEE)))throw"Unsupported slate.";if(this.fee="fee"in e==!0?new BigNumber(e.fee):r.getFee(),"off"in e==!1||!1===Common.isHexString(e.off)||Common.hexStringLength(e.off)!==Crypto.BLINDING_FACTOR_LENGTH||!1===Secp256k1Zkp.isValidSecretKey(Common.fromHexString(e.off)))throw"Unsupported slate.";this.offset=Common.fromHexString(e.off)}this.kernels.push(new SlateKernel(this.getKernelFeatures(),this.getFee(),this.getLockHeight(),this.getRelativeHeight()));break;default:throw"Unsupported slate."}var c=[],E=!1;for(u=0;u<this.getParticipants().length;++u){g=this.getParticipants()[u];if(c.indexOf(g.getId().toFixed())!==Common.INDEX_NOT_FOUND)throw"Unsupported slate.";c.push(g.getId().toFixed()),!0===g.isSender()&&(E=!0)}if(!1===E)throw"Unsupported slate.";if(!1===this.verifyPartialSignatures())throw"Unsupported slate.";if(!1===this.verifyReceiverSignature(t))throw"Unsupported slate.";if(!1===this.verifyWeight())throw"Unsupported slate.";if(!1===this.verifyNoRecentDuplicateKernels(t))throw"Unsupported slate.";if(!1===this.verifySortedAndUnique())throw"Unsupported slate.";if(!1===this.verifyNoCutThrough())throw"Unsupported slate.";if(0===this.getKernels().length)throw"Unsupported slate.";if(this.getKernelFeatures()!==this.getKernels()[0].getFeatures())throw"Unsupported slate.";if(!0===this.getKernels()[0].isComplete()&&!1===this.verifyKernelSums())throw"Unsupported slate."}minimumCompatibleVersion(e){switch(Consensus.getWalletType()){case Consensus.MWC_WALLET_TYPE:return e.indexOf(Slate.VERSION_SLATEPACK)!==Common.INDEX_NOT_FOUND&&this.getKernelFeatures()===SlateKernel.PLAIN_FEATURES?Slate.VERSION_SLATEPACK:this.getTimeToLiveCutOffHeight()!==Slate.NO_TIME_TO_LIVE_CUT_OFF_HEIGHT||!0===this.hasPaymentProof()||e.indexOf("V"+Slate.VERSION_TWO.toFixed())===Common.INDEX_NOT_FOUND?Slate.VERSION_THREE:Slate.VERSION_TWO;case Consensus.GRIN_WALLET_TYPE:return Slate.VERSION_FOUR}}verifyPartialSignatures(){try{var e=SlateKernel.signatureMessage(this.getKernelFeatures(),this.getFee(),this.getLockHeight(),this.getRelativeHeight())}catch(e){return!1}var t=Secp256k1Zkp.combinePublicKeys(this.getParticipants().map((function(e){return e.getPublicNonce()})));if(t===Secp256k1Zkp.OPERATION_FAILED)return!1;var i=Secp256k1Zkp.combinePublicKeys(this.getParticipants().map((function(e){return e.getPublicBlindExcess()})));if(i===Secp256k1Zkp.OPERATION_FAILED)return!1;for(var r=0;r<this.getParticipants().length;++r){var s=this.getParticipants()[r];if(!0===s.isComplete()&&!1===Secp256k1Zkp.verifySingleSignerSignature(s.getPartialSignature(),e,t,s.getPublicBlindExcess(),i,!0))return!1}return!0}verifyReceiverSignature(e){if(this.getReceiverSignature()!==Slate.NO_RECEIVER_SIGNATURE){try{var t=this.getExcess()}catch(e){return!1}try{var i=Slate.getPaymentProofMessage(this.getAmount(),t,this.getSenderAddress());switch(Consensus.getWalletType()){case Consensus.MWC_WALLET_TYPE:switch(this.getReceiverAddress().length){case Mqs.ADDRESS_LENGTH:var r=new Uint8Array(sha256.arrayBuffer(i)),s=Mqs.mqsAddressToPublicKey(this.getReceiverAddress(),e);if(!1===Secp256k1Zkp.verifyMessageHashSignature(this.getReceiverSignature(),r,s))return!1;break;case Tor.ADDRESS_LENGTH:s=Tor.torAddressToPublicKey(this.getReceiverAddress());if(!1===Ed25519.verify(i,this.getReceiverSignature(),s))return!1}break;case Consensus.GRIN_WALLET_TYPE:if(this.getReceiverAddress().length===Slatepack.ADDRESS_LENGTH){s=Slatepack.slatepackAddressToPublicKey(this.getReceiverAddress());if(!1===Ed25519.verify(i,this.getReceiverSignature(),s))return!1}}}catch(e){return!1}}return!0}verifyWeight(){var e=Consensus.BLOCK_OUTPUT_WEIGHT+Consensus.BLOCK_KERNEL_WEIGHT,t=Math.max(Consensus.MAXIMUM_BLOCK_WEIGHT-e,0);return!0!==Slate.getWeight(this.getInputs().length,this.getOutputs().length,this.getKernels().length).isGreaterThan(t)}verifyNoRecentDuplicateKernels(e){if(!0===Consensus.isNoRecentDuplicateKernelsEnabled(e))for(var t=[],i=0;i<this.getKernels().length;++i){var r=this.getKernels()[i];if(!0===r.isNoRecentDuplicate()){if(t.indexOf(Common.toHexString(r.getExcess))!==Common.INDEX_NOT_FOUND)return!1;t.push(Common.toHexString(r.getExcess()))}}return!0}verifySortedAndUnique(){if(!1===Slate.isSortedAndUnique(this.getInputs().map((function(e){return e.getHash()}))))return!1;if(!1===Slate.isSortedAndUnique(this.getOutputs().map((function(e){return e.getHash()}))))return!1;try{if(!1===Slate.isSortedAndUnique(this.getKernels().map((function(e){return e.getHash()}))))return!1}catch(e){return!1}return!0}verifyNoCutThrough(){for(var e=[],t=0;t<this.getInputs().length;++t){var i=this.getInputs()[t].getHash().serialize();if(e.indexOf(i)!==Common.INDEX_NOT_FOUND)return!1;e.push(i)}for(t=0;t<this.getOutputs().length;++t){i=this.getOutputs()[t].getHash().serialize();if(e.indexOf(i)!==Common.INDEX_NOT_FOUND)return!1;e.push(i)}return!0}verifyFees(e){var t=Slate.getRequiredFee(this.getInputs().length,this.getOutputs().length,this.getKernels().length,e);return!0!==t.isGreaterThan(this.getOverage())&&(!0!==t.isGreaterThan(this.getAmount().plus(this.getFee()))&&(!0!==t.isLessThan(Slate.MINIMUM_FEE)&&!0!==t.isGreaterThan(Slate.MAXIMUM_FEE)))}verifyKernelSums(){for(var e=this.getKernels().map((function(e){return e.getExcess()})),t=0;t<e.length;++t){var i=e[t];!0===Common.arraysAreEqual(i,Slate.ZERO_COMMIT)&&e.splice(t--,1)}var r=Secp256k1Zkp.pedersenCommitSum(e,[]);if(r===Secp256k1Zkp.OPERATION_FAILED)return!1;var s=[r];try{var n=this.getOffsetExcess()}catch(e){return!1}s.push(n);var a=Secp256k1Zkp.pedersenCommitSum(s,[]);if(a===Secp256k1Zkp.OPERATION_FAILED)return!1;var o=this.getCommitsSum();return!1!==o&&!1!==Common.arraysAreEqual(o,a)}getKernelFeatures(){return!1===this.getLockHeight().isEqualTo(Slate.NO_LOCK_HEIGHT)?SlateKernel.HEIGHT_LOCKED_FEATURES:this.getRelativeHeight()!==Slate.NO_RELATIVE_HEIGHT?SlateKernel.NO_RECENT_DUPLICATE_FEATURES:SlateKernel.PLAIN_FEATURES}getOverage(){for(var e=new BigNumber(0),t=0;t<this.getKernels().length;++t){var i=this.getKernels()[t];switch(i.getFeatures()){case SlateKernel.PLAIN_FEATURES:case SlateKernel.HEIGHT_LOCKED_FEATURES:case SlateKernel.NO_RECENT_DUPLICATE_FEATURES:e=e.plus(i.getFee())}}return e}getCommitsSum(){var e=this.getInputs().map((function(e){return e.getCommit()})),t=this.getOutputs().map((function(e){return e.getCommit()})),i=this.getOverage();if(!1===i.isZero()){try{var r=Crypto.commitAmount(i.absoluteValue())}catch(e){return!1}!0===i.isNegative()?e.push(r):t.push(r)}for(var s=0;s<e.length;++s){var n=e[s];!0===Common.arraysAreEqual(n,Slate.ZERO_COMMIT)&&e.splice(s--,1)}for(s=0;s<t.length;++s){var a=t[s];!0===Common.arraysAreEqual(a,Slate.ZERO_COMMIT)&&t.splice(s--,1)}var o=Secp256k1Zkp.pedersenCommitSum(t,e);return o!==Secp256k1Zkp.OPERATION_FAILED&&o}updateKernel(){switch(this.kernels=[],this.getKernelFeatures()){case SlateKernel.PLAIN_FEATURES:var e=this.getFee(),t=Slate.NO_LOCK_HEIGHT,i=Slate.NO_RELATIVE_HEIGHT;break;case SlateKernel.HEIGHT_LOCKED_FEATURES:e=this.getFee(),t=this.getLockHeight(),i=Slate.NO_RELATIVE_HEIGHT;break;case SlateKernel.NO_RECENT_DUPLICATE_FEATURES:e=this.getFee(),t=Slate.NO_LOCK_HEIGHT,i=this.getRelativeHeight()}var r=new SlateKernel(this.getKernelFeatures(),e,t,i);this.kernels.push(r)}sort(){this.inputs.sort((function(e,t){return e.getHash().compare(t.getHash())})),this.outputs.sort((function(e,t){return e.getHash().compare(t.getHash())}));try{this.kernels.sort((function(e,t){return e.getHash().compare(t.getHash())}))}catch(e){return!1}return!0}hasPaymentProof(){return this.getReceiverAddress()!==Slate.NO_RECEIVER_ADDRESS&&this.getSenderAddress()!==Slate.NO_SENDER_ADDRESS}createPartialSignature(e,t,i,r,s=HardwareWallet.NO_TEXT,n=[],a=!1,o=!1,u=Common.NO_CANCEL_OCCURED){var g=this;return new Promise((function(r,l){return new Promise((function(t,i){if(e instanceof Uint8Array!=1)return e.getTransactionPublicKey(s,n,a,o,u).then((function(e){t(e)})).catch((function(e){i(e)}));var r=e,g=Secp256k1Zkp.publicKeyFromSecretKey(r);g===Secp256k1Zkp.OPERATION_FAILED?i("Getting public blind excess failed."):t(g)})).then((function(_){return new Promise((function(i,r){if(e instanceof Uint8Array!=1){var g=e,l=t;return l!==Slate.NO_ENCRYPTED_SECRET_NONCE?g.setTransactionEncryptedSecretNonce(l,s,n,a,o,u).then((function(){return g.getTransactionPublicNonce(s,n,a,o,u).then((function(e){i(e)})).catch((function(e){r(e)}))})).catch((function(e){r(e)})):g.getTransactionPublicNonce(s,n,a,o,u).then((function(e){i(e)})).catch((function(e){r(e)}))}var _=t,h=Secp256k1Zkp.publicKeyFromSecretKey(_);h===Secp256k1Zkp.OPERATION_FAILED?r("Getting a public nonce failed."):i(h)})).then((function(h){try{var c=SlateKernel.signatureMessage(g.getKernelFeatures(),g.getFee(),g.getLockHeight(),g.getRelativeHeight())}catch(e){return void l("Getting message to sign failed.")}var E=g.getParticipants().map((function(e){return e.getPublicNonce()}));!0===i&&E.push(h);var S=Secp256k1Zkp.combinePublicKeys(E);if(S===Secp256k1Zkp.OPERATION_FAILED)l("Getting public nonce sum failed.");else{var p=g.getParticipants().map((function(e){return e.getPublicBlindExcess()}));!0===i&&p.push(_);var T=Secp256k1Zkp.combinePublicKeys(p);if(T!==Secp256k1Zkp.OPERATION_FAILED){return new Promise((function(r,l){if(e instanceof Uint8Array!=1){var h=e;try{var E=g.getExcess(!0===i?_:Slate.NO_PUBLIC_BLIND_EXCESS)}catch(e){return void l(e)}return!1===i?h.getTransactionInformation(S,T,g.getKernelFeatures(),g.getLockHeight(),g.getRelativeHeight(),g.getSenderAddress()!==Slate.NO_SENDER_ADDRESS?E:HardwareWallet.NO_KERNEL_COMMIT,g.getSenderAddress(),g.getReceiverSignature(),s,n,a,o,u).then((function(e){r(e[HardwareWallet.TRANSACTION_INFORMATION_SIGNATURE_INDEX])})).catch((function(e){l(e)})):h.getTransactionInformation(S,T,g.getKernelFeatures(),g.getLockHeight(),g.getRelativeHeight(),g.getSenderAddress()!==Slate.NO_SENDER_ADDRESS?E:HardwareWallet.NO_KERNEL_COMMIT,g.getReceiverAddress(),Slate.NO_RECEIVER_SIGNATURE,s,n,a,o,u).then((function(e){e[HardwareWallet.TRANSACTION_INFORMATION_PAYMENT_PROOF_INDEX]!==HardwareWallet.NO_PAYMENT_PROOF?(g.setReceiverSignature(e[HardwareWallet.TRANSACTION_INFORMATION_PAYMENT_PROOF_INDEX]),r(e[HardwareWallet.TRANSACTION_INFORMATION_SIGNATURE_INDEX])):r(e[HardwareWallet.TRANSACTION_INFORMATION_SIGNATURE_INDEX])})).catch((function(e){l(e)}))}var p=e,f=t,N=Secp256k1Zkp.createSingleSignerSignature(c,p,f,T,S,S);N===Secp256k1Zkp.OPERATION_FAILED?l("Creating partial signature failed."):r(N)})).then((function(e){r(e)})).catch((function(e){l(e)}))}l("Getting public blind excess sum failed.")}})).catch((function(e){l(e)}))})).catch((function(e){l(e)}))}))}static getWeight(e,t,i){var r=new BigNumber(e).multipliedBy(Consensus.BLOCK_INPUT_WEIGHT),s=new BigNumber(t).multipliedBy(Consensus.BLOCK_OUTPUT_WEIGHT),n=new BigNumber(i).multipliedBy(Consensus.BLOCK_KERNEL_WEIGHT);return r.plus(s).plus(n)}static detectVersion(e,t){switch(Consensus.getWalletType()){case Consensus.MWC_WALLET_TYPE:return e instanceof Uint8Array==!0?Slate.VERSION_SLATEPACK:"coin_type"in e==!0&&e.coin_type!==Slate.COIN_TYPE||"network_type"in e==!0&&e.network_type!==Slate.getNetworkType(t)?Slate.UNKNOWN_VERSION:"version_info"in e!=!0||!0!==Object.isObject(e.version_info)||"version"in e.version_info!=!0||!0!==Common.isNumberString(e.version_info.version)&&e.version_info.version instanceof BigNumber!=!0||!0!==new BigNumber(e.version_info.version).isInteger()?"version"in e!=!0||!0!==Common.isNumberString(e.version)&&e.version instanceof BigNumber!=!0||!0!==new BigNumber(e.version).isInteger()?Slate.UNKNOWN_VERSION:Slate.VERSION_ONE:new BigNumber(e.version_info.version);case Consensus.GRIN_WALLET_TYPE:return"ver"in e==!0&&"string"==typeof e.ver&&!0===Slate.VERSION_PATTERN.test(e.ver)?new BigNumber(e.ver.split(Slate.VERSION_SEPARATOR)[0]):Slate.UNKNOWN_VERSION}}static isSortedAndUnique(e){for(var t=1;t<e.length;++t){var i=e[t-1],r=e[t].compare(i);if(r===Hash.LESS_THAN||r===Hash.EQUAL_TO)return!1}return!0}static getNetworkType(e){return!0===e?"mainnet":"floonet"}static uncompactProofAddress(e,t){if(e.getBits(Slate.COMPACT_BOOLEAN_LENGTH)===Slate.COMPACT_BOOLEAN_TRUE)var i=Mqs.publicKeyToMqsAddress(Slate.uncompactPublicKey(e),t);else i=Tor.publicKeyToTorAddress(e.getBytes(Crypto.ED25519_PUBLIC_KEY_LENGTH));return i}static compactProofAddress(e,t,i){switch(e.length){case Mqs.ADDRESS_LENGTH:i.setBits(Slate.COMPACT_BOOLEAN_TRUE,Slate.COMPACT_BOOLEAN_LENGTH),Slate.compactPublicKey(Mqs.mqsAddressToPublicKey(e,t),i);break;case Tor.ADDRESS_LENGTH:i.setBits(Slate.COMPACT_BOOLEAN_FALSE,Slate.COMPACT_BOOLEAN_LENGTH),i.setBytes(Tor.torAddressToPublicKey(e))}}static purposeToText(e){switch(e){case Slate.COMPACT_SLATE_PURPOSE_SEND_INITIAL:return"S1";case Slate.COMPACT_SLATE_PURPOSE_SEND_RESPONSE:return"S2"}}static get VERSION_ONE(){return new BigNumber(1)}static get VERSION_TWO(){return new BigNumber(2)}static get VERSION_THREE(){return new BigNumber(3)}static get VERSION_FOUR(){return new BigNumber(4)}static get VERSION_SLATEPACK(){return"SP"}static get UNKNOWN_VERSION(){return null}static get NO_LOCK_HEIGHT(){return new BigNumber(0)}static get NO_RELATIVE_HEIGHT(){return null}static get MINIMUM_NUMBER_OF_PARTICIPANTS(){return 2}static get ZERO_OFFSET(){return Crypto.ZERO_BLINDING_FACTOR}static get NO_PARTICIPANT(){return null}static get NO_RECEIVER_ADDRESS(){return null}static get NO_RECEIVER_SIGNATURE(){return null}static get NO_SENDER_ADDRESS(){return null}static get ZERO_COMMIT(){return new Uint8Array(Crypto.COMMIT_LENGTH).fill(0)}static get BODY_WEIGHT_OUTPUT_FACTOR(){return 4}static get MINIMUM_BODY_WEIGHT(){return 1}static get DEFAULT_NUMBER_OF_PARTICIPANTS(){return new BigNumber(2)}static get COIN_TYPE(){if(Consensus.getWalletType()===Consensus.MWC_WALLET_TYPE)return"mwc"}static get COMPACT_BOOLEAN_LENGTH(){return 1}static get COMPACT_BOOLEAN_FALSE(){return 0}static get COMPACT_BOOLEAN_TRUE(){return Slate.COMPACT_BOOLEAN_FALSE+1}static get COMPACT_SLATE_PURPOSE_LENGTH(){return 3}static get COMPACT_SLATE_PURPOSE_SEND_INITIAL(){return 0}static get COMPACT_SLATE_PURPOSE_SEND_RESPONSE(){return Slate.COMPACT_SLATE_PURPOSE_SEND_INITIAL+1}static get COMPACT_PROOF_SIGNATURE_LENGTH_LENGTH(){return 4}static get COMPACT_NUMBER_OF_HUNDREDS_LENGTH(){return 3}static get COMPACT_NUMBER_OF_DIGITS_LENGTH(){return 6}static get COMPACT_HUNDREDS_SCALING_FACTOR(){return 100}static get COMPACT_PUBLIC_KEY_LENGTH_LENGTH(){return 7}static get NO_PUBLIC_BLIND_EXCESS(){return null}static get VERSION_PATTERN(){return/^\d+:\d+$/u}static get VERSION_SEPARATOR(){return":"}static get MINIMUM_AMOUNT(){return 1}}module.exports=Slate;